package com.abc.tktbooking.service;

import java.util.List;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.abc.tktbooking.entity.Route;
import com.abc.tktbooking.entity.TicketBooking;
import com.abc.tktbooking.entity.User;
import com.abc.tktbooking.exceptions.ResourceNotFoundException;
import com.abc.tktbooking.payload.TicketBookingPayload;
import com.abc.tktbooking.repository.TicketBookingRepository;

@Service
public class TicketBookingServiceImpl implements TicketBookingService{
	
	@Autowired
	private TicketBookingRepository ticketBookingRepository;
	
	@Autowired
	private UserService userService;
	
	@Autowired
	private RouteService routeService;

	@Override
	public TicketBooking getTicketBookingDetails(int bookingId) {
		Optional<TicketBooking> optionalTicketBooking = ticketBookingRepository.findById(bookingId);
		if(optionalTicketBooking.isEmpty()) {
			throw new ResourceNotFoundException("Ticket booking not found with Id : " + bookingId);
		}
		TicketBooking ticketBooking = optionalTicketBooking.get();
		return ticketBooking;
	}

	@Override
	public List<TicketBooking> getAllTicketBookings() {
		List<TicketBooking> ticketBookings = ticketBookingRepository.findAll();
		return ticketBookings;
	}

	@Override
	public List<TicketBooking> getAllTicketBookingByUserId(int userId) {
		User user = userService.getUserById(userId);
		List<TicketBooking> userBookings = user.getTicketBookings();
		return userBookings;
	}

	@Override
	public List<TicketBooking> getAllTicketBookingByRouteId(int routeId) {
		Route route = routeService.getRouteById(routeId);
		List<TicketBooking> routeBookings = route.getTicketBookings();
		return routeBookings;
	}

	@Override
	public TicketBooking updateTicketBookingStatus(int bookingId, String status) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public void deleteTicketBooking(int bookingId) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public TicketBooking createTicketBooking(TicketBookingPayload ticketBookingPayload) {
		// TODO Auto-generated method stub
		return null;
	}

}
